# Dynamics-Aware-Robust-Training
The codebase for the paper "Exploring and Exploiting Decision Boundary Dynamics for Adversarial Robustness" (ICLR 2023, https://openreview.net/forum?id=aRTKuscKByJ) by Yuancheng Xu, Yanchao Sun, Micah Goldblum, Tom Goldstein and Furong Huang. 

The implementation of DyART (Dynamics-aware robust training) is provided.

## Environment set-up
* Create a new environment using the .yml file
```
conda env create -f environment.yml
```
* Install AutoAttack for evaluation
```
pip install git+https://github.com/fra31/auto-attack
```

## Data Preparation (optional)
### Tiny-ImageNet
Dowload the Tiny-ImageNet dataset via the following
```
bash data/TinyImageNet-200.sh
```

### Additional data for CIFAR-10
Rebuffi et al. (2021) and Gowal et al. (2021) use samples generated by a Denoising Diffusion Probabilistic Model to improve robustness. The generated model is solely trained on the original training data. You can  download the 1M generated data for CIFAR-10 [here](https://github.com/deepmind/deepmind-research/tree/master/adversarial_robustness#datasets ). You need to put the downloaded file *cifar10_ddpm.npz* under the folder *data/*.

## Running DyART
The *.scripts/* folder includes bash scripts for running DyART on CIFAR-10 and Tiny-ImageNet.

### CIFAR-10
First run 10 epochs for the burn-in period.
```
bash scripts/Cifar10_clean_training.sh
```

Then run DyART without additional data
```
bash scripts/Cifar10_DyART.sh
```

Or run DyART with additional data
```
bash scripts/Cifar10_DyART_additional_data.sh
```

### Tiny-ImageNet
First run 20 epochs for the burn-in period
```
bash scripts/TinyImgNet_clean_training.sh
```

Then run DyART
```
bash scripts/TinyImgNet_DyART.sh
```

### Resuming from previous checkpoints

Each experiment will generate a folder, containing the parameters of the experiment, best checkpoint, the most recent checkpoint and a log. To resume an unfinished experiment, put the folder directory into *scripts/resume.sh* and run
```
bash scripts/resume.sh
```

## AutoAttack Evaluation
Provide the experiment folder directory in *bash/eval.sh* and run
```
bash scripts/eval.sh
```
## Citation
```
@inproceedings{
xu2023exploring,
title={Exploring and Exploiting Decision Boundary Dynamics for Adversarial Robustness},
author={Yuancheng Xu and Yanchao Sun and Micah Goldblum and Tom Goldstein and Furong Huang},
booktitle={International Conference on Learning Representations},
year={2023},
url={https://openreview.net/forum?id=aRTKuscKByJ}
}
```
